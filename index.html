<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Latihan Mandiri - MSIM4408 & STDA4101</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        .fade-enter-active, .fade-leave-active { transition: opacity 0.3s ease; }
        .fade-enter-from, .fade-leave-to { opacity: 0; }
        body { background-color: #f8fafc; }
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #94a3b8; }
        
        /* Table Styling untuk Soal */
        .soal-table { width: 100%; border-collapse: collapse; margin: 10px 0; font-size: 0.9em; }
        .soal-table th, .soal-table td { border: 1px solid #cbd5e1; padding: 6px; text-align: left; }
        .soal-table th { background-color: #f1f5f9; }
    </style>
</head>
<body>
    <div id="app" class="min-h-screen flex flex-col font-sans text-slate-800">
        
        <nav class="bg-indigo-900 text-white shadow-lg sticky top-0 z-50">
            <div class="container mx-auto px-4 py-3 flex justify-between items-center">
                <div class="flex items-center gap-3 cursor-pointer" @click="goHome">
                    <i class="fas fa-university text-2xl text-indigo-300"></i>
                    <div>
                        <h1 class="font-bold text-lg leading-tight">Latihan Mandiri UT</h1>
                        <p class="text-xs text-indigo-300">Sistem Latihan Soal Interaktif</p>
                    </div>
                </div>
                
                <div class="hidden md:flex text-sm font-medium text-indigo-200 gap-2 items-center">
                    <span :class="step >= 1 ? 'text-white' : ''">Matkul</span>
                    <i class="fas fa-chevron-right text-xs"></i>
                    <span :class="step >= 2 ? 'text-white' : ''">Modul</span>
                    <i class="fas fa-chevron-right text-xs"></i>
                    <span :class="step >= 3 ? 'text-white' : ''">Tes</span>
                </div>
            </div>
        </nav>

        <main class="container mx-auto px-4 py-8 flex-grow">
            
            <div v-if="step > 1" class="mb-6">
                <button @click="goBack" class="flex items-center text-indigo-700 hover:text-indigo-900 font-semibold transition">
                    <i class="fas fa-arrow-left mr-2"></i> Kembali
                </button>
            </div>

            <transition name="fade" mode="out-in">
                <div v-if="step === 1" key="step1">
                    <h2 class="text-2xl font-bold mb-6 border-b-2 border-indigo-200 pb-2">Pilih Mata Kuliah</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                        <div v-for="mk in matakuliahList" :key="mk.kode" 
                            @click="selectMatkul(mk)"
                            class="bg-white rounded-xl shadow-md hover:shadow-xl hover:-translate-y-1 transition-all cursor-pointer overflow-hidden border border-slate-200">
                            <div class="h-2 bg-indigo-600"></div>
                            <div class="p-6">
                                <div class="flex justify-between items-start mb-4">
                                    <span class="bg-indigo-100 text-indigo-800 text-xs font-bold px-2 py-1 rounded">{{ mk.kode }}</span>
                                    <i class="fas fa-book text-indigo-200 text-4xl"></i>
                                </div>
                                <h3 class="text-xl font-bold text-slate-800 mb-2">{{ mk.nama }}</h3>
                                <p class="text-sm text-slate-500">{{ Object.keys(mk.modul).length }} Modul Tersedia</p>
                            </div>
                        </div>
                    </div>
                </div>

                <div v-else-if="step === 2" key="step2">
                    <h2 class="text-2xl font-bold mb-2">{{ selectedMatkul.nama }}</h2>
                    <p class="text-slate-500 mb-6 border-b pb-4">Kode: {{ selectedMatkul.kode }}</p>
                    
                    <h3 class="text-lg font-semibold mb-4 text-indigo-800"><i class="fas fa-layer-group mr-2"></i>Daftar Modul</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div v-for="(content, modulName) in selectedMatkul.modul" :key="modulName"
                            @click="selectModul(modulName)"
                            class="bg-white p-5 rounded-lg shadow hover:shadow-md border-l-4 border-indigo-500 cursor-pointer hover:bg-indigo-50 transition flex justify-between items-center group">
                            <span class="font-bold text-lg text-slate-700 group-hover:text-indigo-700">{{ modulName }}</span>
                            <i class="fas fa-chevron-right text-slate-300 group-hover:text-indigo-500"></i>
                        </div>
                    </div>
                </div>

                <div v-else-if="step === 3" key="step3">
                    <h2 class="text-2xl font-bold mb-1">{{ selectedModulName }}</h2>
                    <p class="text-slate-500 mb-6 border-b pb-4">{{ selectedMatkul.nama }}</p>

                    <h3 class="text-lg font-semibold mb-4 text-indigo-800"><i class="fas fa-tasks mr-2"></i>Pilih Latihan Tes</h3>
                    <div class="grid grid-cols-1 gap-4">
                        <div v-for="(soalList, tesName) in getTesList" :key="tesName"
                            @click="selectTes(tesName)"
                            class="bg-white p-6 rounded-lg shadow hover:shadow-md cursor-pointer border border-slate-200 hover:border-indigo-300 transition relative overflow-hidden">
                            <div class="absolute top-0 right-0 p-4 opacity-10">
                                <i class="fas fa-pencil-alt text-6xl"></i>
                            </div>
                            <h4 class="text-xl font-bold text-indigo-700 mb-2">{{ tesName }}</h4>
                            <p class="text-sm text-slate-500">{{ soalList.length }} Soal / Kasus</p>
                            <div class="mt-4 flex gap-2">
                                <span class="text-xs bg-green-100 text-green-700 px-2 py-1 rounded" 
                                      v-if="hasHistory(selectedMatkul.kode, selectedModulName, tesName)">
                                    <i class="fas fa-history mr-1"></i>Pernah Dikerjakan
                                </span>
                            </div>
                        </div>
                    </div>
                </div>

                <div v-else-if="step === 4" key="step4">
                    <div class="bg-white rounded-xl shadow-xl overflow-hidden min-h-[600px] flex flex-col">
                        <div class="bg-indigo-50 p-6 border-b border-indigo-100 flex flex-col md:flex-row justify-between items-center gap-4">
                            <div>
                                <h2 class="text-xl font-bold text-indigo-900">{{ selectedTesName }}</h2>
                                <p class="text-sm text-indigo-600">{{ selectedModulName }}</p>
                            </div>
                            <button @click="resetCurrentTes" class="bg-orange-500 hover:bg-orange-600 text-white px-4 py-2 rounded-lg shadow text-sm font-bold transition flex items-center">
                                <i class="fas fa-redo-alt mr-2"></i> Reset Sesi Ini
                            </button>
                        </div>

                        <div class="p-6 md:p-8 flex-grow">
                            <div v-for="(soal, index) in currentSoalList" :key="soal.id" class="mb-12 border-b border-slate-100 pb-8 last:border-0">
                                
                                <div class="flex gap-4 mb-5">
                                    <div class="flex-shrink-0 w-8 h-8 bg-indigo-600 text-white rounded-full flex items-center justify-center font-bold text-sm mt-1">
                                        {{ index + 1 }}
                                    </div>
                                    <div class="text-lg text-slate-800 font-medium leading-relaxed w-full">
                                        <div v-html="soal.pertanyaan"></div>
                                    </div>
                                </div>

                                <div v-if="soal.tipe === 'pg'" class="pl-12 space-y-3">
                                    <div v-for="(teks, key) in soal.pilihan" :key="key" class="relative">
                                        <input type="radio" 
                                            :name="soal.id" 
                                            :id="soal.id + key" 
                                            :value="key"
                                            :disabled="isAnsweredInCurrentSession(soal.id)"
                                            @change="submitAnswer(soal, key)"
                                            class="peer sr-only">
                                        
                                        <label :for="soal.id + key"
                                            :class="['flex items-center p-3 rounded-lg border-2 transition-all cursor-pointer select-none',
                                                getOptionClass(soal, key)
                                            ]">
                                            <div class="w-6 h-6 rounded-full border-2 flex items-center justify-center mr-3 font-bold text-xs"
                                                :class="getOptionBulletClass(soal, key)">
                                                {{ key }}
                                            </div>
                                            <span class="text-slate-700">{{ teks }}</span>
                                        </label>
                                    </div>

                                    <div v-if="isAnsweredInCurrentSession(soal.id)" class="mt-4 animate-fade-in-down">
                                        <div :class="['p-4 rounded-lg border-l-4 shadow-sm', 
                                            getLastAnswer(soal.id).isCorrect ? 'bg-green-50 border-green-500' : 'bg-red-50 border-red-500']">
                                            
                                            <div class="flex items-center gap-2 font-bold text-lg mb-1" 
                                                 :class="getLastAnswer(soal.id).isCorrect ? 'text-green-700' : 'text-red-700'">
                                                <i :class="['fas', getLastAnswer(soal.id).isCorrect ? 'fa-check-circle' : 'fa-times-circle']"></i>
                                                {{ getLastAnswer(soal.id).isCorrect ? 'Jawaban Benar' : 'Jawaban Salah' }}
                                            </div>
                                            <p v-if="!getLastAnswer(soal.id).isCorrect" class="text-sm text-red-800 mb-2">
                                                Jawaban yang tepat: <strong>{{ soal.kunci }}. {{ soal.pilihan[soal.kunci] }}</strong>
                                            </p>
                                            <div class="mt-2 text-sm text-slate-600 bg-white/50 p-3 rounded">
                                                <strong class="block text-indigo-900 mb-1">Penjelasan:</strong>
                                                {{ soal.penjelasan }}
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div v-else-if="soal.tipe === 'essay'" class="pl-12">
                                    <div class="bg-slate-50 p-4 rounded-lg border border-slate-200 mb-4">
                                        <p class="text-sm text-slate-500 italic mb-2"><i class="fas fa-pencil-alt mr-1"></i> Soal Uraian / Hitungan. Silakan kerjakan di kertas terlebih dahulu.</p>
                                        <textarea class="w-full p-3 border rounded-md focus:ring-2 focus:ring-indigo-400 focus:outline-none" rows="3" placeholder="Tulis catatan atau jawabanmu di sini (opsional)..."></textarea>
                                    </div>

                                    <button @click="toggleEssayAnswer(soal.id)" 
                                        class="bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded shadow transition flex items-center">
                                        <i class="fas fa-key mr-2"></i> {{ showEssay[soal.id] ? 'Tutup Pembahasan' : 'Lihat Kunci Jawaban & Pembahasan' }}
                                    </button>

                                    <div v-if="showEssay[soal.id]" class="mt-4 animate-fade-in-down p-4 bg-yellow-50 border-l-4 border-yellow-500 rounded text-slate-800">
                                        <h4 class="font-bold text-yellow-800 mb-2"><i class="fas fa-lightbulb mr-2"></i>Pembahasan Langkah-demi-Langkah:</h4>
                                        <div class="text-sm leading-relaxed whitespace-pre-line" v-html="soal.pembahasan"></div>
                                    </div>
                                </div>

                            </div>
                            
                            <div class="mt-8 border-t pt-6 text-center">
                                <button @click="goBack" class="text-indigo-600 font-bold hover:underline">
                                    Pilih Tes Lain
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

            </transition>
        </main>

        <footer class="bg-slate-800 text-slate-400 py-6 text-center text-sm">
            <p>Dibuat untuk Latihan Mandiri Mahasiswa UT</p>
            <p class="text-xs mt-1">MSIM4408 & STDA4101</p>
        </footer>
    </div>

    <script>
        const { createApp, ref, computed, onMounted } = Vue;

        createApp({
            setup() {
                const step = ref(1);
                const selectedMatkul = ref(null);
                const selectedModulName = ref('');
                const selectedTesName = ref('');
                const showEssay = ref({}); // State untuk toggle jawaban essay

                const matakuliahList = ref([
                    // --- MATKUL 1: ETIKA PROFESI (MSIM4408) ---
                    {
                        kode: "MSIM4408",
                        nama: "Etika Profesi",
                        modul: {
                            "Modul 1: Prinsip Dasar Etika": {
                                "Tes Formatif 1": [
                                    { id: "m1-tf1-1", tipe: "pg", pertanyaan: "Kata etika berasal dari bahasa Yunani Kuno, yaitu 'ethikos' yang berarti ....", pilihan: { A: "asas bersama", B: "timbul dari kebiasaan", C: "akhlak mulia", D: "moral utama" }, kunci: "B", penjelasan: "Kata 'ethikos' berarti 'timbul dari kebiasaan' (adat istiadat)." },
                                    { id: "m1-tf1-2", tipe: "pg", pertanyaan: "Menurut Aristoteles... Ilmu pengetahuan yang mempelajari suatu problem tindakan manusia adalah ....", pilihan: { A: "Manner", B: "Terminius Technicus", C: "Custom", D: "Technicus Manner" }, kunci: "B", penjelasan: "'Terminius Technicus' adalah etika sebagai ilmu pengetahuan yang mempelajari problem tindakan manusia." },
                                    { id: "m1-tf1-3", tipe: "pg", pertanyaan: "Secara umum etika dibagi menjadi dua, yaitu etika ....", pilihan: { A: "khusus dan spesial", B: "umum dan khusus", C: "khusus dan individual", D: "umum dan sosial" }, kunci: "B", penjelasan: "Pembagian etika dasar: Etika Umum dan Etika Khusus." },
                                    { id: "m1-tf1-4", tipe: "pg", pertanyaan: "Etika yang mengajarkan hal baik/buruk berdasarkan ajaran agama adalah etika ....", pilihan: { A: "sosiologis", B: "deskriptif", C: "teologis", D: "normatif" }, kunci: "C", penjelasan: "Etika Teologis mendasarkan pada dalil agama." },
                                    { id: "m1-tf1-5", tipe: "pg", pertanyaan: "Etika yang menetapkan kewajiban manusia untuk hidup lebih baik adalah etika ....", pilihan: { A: "normatif", B: "filosofis", C: "sosiologis", D: "deskriptif" }, kunci: "A", penjelasan: "Etika Normatif bersifat preskriptif (menetapkan standar)." }
                                ],
                                "Tes Formatif 2": [
                                    { id: "m1-tf2-1", tipe: "pg", pertanyaan: "Profesi berasal dari bahasa Latin 'professus' yang berarti ....", pilihan: { A: "bisa", B: "ahli", C: "ringan", D: "sesuai" }, kunci: "B", penjelasan: "Professus berarti menyatakan secara publik (mengakui keahlian)." },
                                    { id: "m1-tf2-2", tipe: "pg", pertanyaan: "Definisi profesional: pekerjaan berdasar studi intelektual dan latihan khusus... dikemukakan oleh ....", pilihan: { A: "Cogan", B: "Peter Jarvis", C: "Dedi Supriyadi", D: "Hughes, E.C." }, kunci: "B", penjelasan: "Peter Jarvis (1983) menekankan pada studi intelektual dan latihan khusus." },
                                    { id: "m1-tf2-3", tipe: "pg", pertanyaan: "Menurut Lakshamana Roa, kriteria profesi kecuali ....", pilihan: { A: "kebebasan", B: "panggilan", C: "bayaran yang sangat memadai", D: "kode etik" }, kunci: "C", penjelasan: "Bayaran tinggi bukan syarat mutlak etis profesi." },
                                    { id: "m1-tf2-4", tipe: "pg", pertanyaan: "Berikut syarat profesi, kecuali ....", pilihan: { A: "akademik", B: "organisasi", C: "kode etik", D: "kerja tanpa batas" }, kunci: "D", penjelasan: "Profesional bekerja dengan batasan wewenang." },
                                    { id: "m1-tf2-5", tipe: "pg", pertanyaan: "Hal pokok yang harus dimiliki profesional adalah ....", pilihan: { A: "keterampilan", B: "kelapangan", C: "kebijaksanaan", D: "pengalaman" }, kunci: "A", penjelasan: "Profesionalisme identik dengan skill/keterampilan." }
                                ]
                            },
                            "Modul 2: Sejarah & Kode Etik TI": {
                                "Tes Formatif 1": [
                                    { id: "m2-tf1-1", tipe: "pg", pertanyaan: "Tiga hal dalam teknologi informasi, kecuali ....", pilihan: { A: "data", B: "alat pengolah", C: "alat penyaring data", D: "metode pengolah" }, kunci: "C", penjelasan: "Komponen utama: Data, Hardware/Software (Alat), Metode." },
                                    { id: "m2-tf1-2", tipe: "pg", pertanyaan: "Teknologi ('la teknique') berarti ....", pilihan: { A: "sarana atau alat", B: "konsep", C: "ide", D: "garis besar" }, kunci: "A", penjelasan: "Teknologi adalah sarana/alat menyediakan barang." },
                                    { id: "m2-tf1-3", tipe: "pg", pertanyaan: "Sejarah TIK dibagi 3 masa, yaitu ....", pilihan: { A: "prasejarah", B: "sejarah", C: "awal sejarah", D: "modern" }, kunci: "D", penjelasan: "Masa Prasejarah, Sejarah, Modern." },
                                    { id: "m2-tf1-4", tipe: "pg", pertanyaan: "Mesir Kuno menggunakan pohon ... sebagai kertas.", pilihan: { A: "pinus", B: "papirus", C: "bambu", D: "jati" }, kunci: "B", penjelasan: "Papyrus adalah media tulis Mesir Kuno." },
                                    { id: "m2-tf1-5", tipe: "pg", pertanyaan: "Johann Gutenberg mengembangkan mesin cetak bingkai kayu tahun ....", pilihan: { A: "1837", B: "1830", C: "1455", D: "1861" }, kunci: "C", penjelasan: "Mesin cetak Gutenberg sukses sekitar 1455." }
                                ],
                                "Tes Formatif 2": [
                                    { id: "m2-tf2-1", tipe: "pg", pertanyaan: "Pengoperasi program EDP disebut ....", pilihan: { A: "MIS", B: "sys admin", C: "operator EDP", D: "EDP programming" }, kunci: "C", penjelasan: "EDP = Electronic Data Processing." },
                                    { id: "m2-tf2-2", tipe: "pg", pertanyaan: "Tanggung jawab profesi TI ....", pilihan: { A: "kemandirian...", B: "etika, kompetensi, dan profesional", C: "etika...", D: "kemandirian..." }, kunci: "B", penjelasan: "Integritas moral, skill teknis, dan sikap profesional." },
                                    { id: "m2-tf2-3", tipe: "pg", pertanyaan: "UU HAKI No 19 Th 2002 berlaku sejak ....", pilihan: { A: "29 Juli 2003", B: "19 Juli 2003", C: "8 Ags 2008", D: "14 Mei 2002" }, kunci: "A", penjelasan: "Berlaku 1 tahun setelah diundangkan (Juli 2002)." },
                                    { id: "m2-tf2-4", tipe: "pg", pertanyaan: "Denial of Services (DoS) artinya ....", pilihan: { A: "pencurian", B: "melumpuhkan bagian", C: "melumpuhkan layanan sistem", D: "virus" }, kunci: "C", penjelasan: "DoS membuat layanan tidak tersedia (down)." },
                                    { id: "m2-tf2-5", tipe: "pg", pertanyaan: "Kode etik programmer, KECUALI ....", pilihan: { A: "no malware", B: "tidak boleh menulis materi agar sulit diikuti dengan sengaja", C: "no bad docs", D: "respect copyright" }, kunci: "B", penjelasan: "Ini soal jebakan. Semua adalah etika, namun B sering dianggap paling 'subjektif' dibanding malware/copyright." }
                                ]
                            }
                        }
                    },
                    // --- MATKUL 2: PENGANTAR SAINS DATA (STDA4101) ---
                    {
                        kode: "STDA4101",
                        nama: "Pengantar Sains Data",
                        modul: {
                            "Ujian Online Uraian": {
                                "Soal Essay & Hitungan": [
                                    {
                                        id: "stda-essay-1",
                                        tipe: "essay",
                                        pertanyaan: `<strong>1. Menghitung Statistik Deskriptif</strong><br>
                                        Perhatikan data nilai ujian tengah semester dari 12 mahasiswa berikut:<br>
                                        <strong>Data:</strong> 72, 68, 75, 80, 70, 78, 65, 72, 76, 69, 74, 71.<br><br>
                                        Hitunglah:
                                        <ul class="list-disc ml-5">
                                            <li>Mean (rata-rata)</li>
                                            <li>Median</li>
                                            <li>Modus</li>
                                            <li>Range (jangkauan)</li>
                                            <li>Standar deviasi</li>
                                        </ul>`,
                                        pembahasan: `<strong>Langkah 1: Urutkan Data (N=12)</strong>
                                        Data urut: 65, 68, 69, 70, 71, 72, 72, 74, 75, 76, 78, 80.

                                        <strong>a. Mean (Rata-rata)</strong>
                                        Rumus: Jumlah semua data / Banyak data
                                        Jumlah = 870
                                        Mean = 870 / 12 = <strong>72.5</strong>

                                        <strong>b. Median (Nilai Tengah)</strong>
                                        Karena N genap (12), median adalah rata-rata data ke-6 dan ke-7.
                                        Data ke-6 = 72, Data ke-7 = 72.
                                        Median = (72 + 72) / 2 = <strong>72</strong>

                                        <strong>c. Modus (Nilai Paling Sering Muncul)</strong>
                                        Nilai 72 muncul 2 kali.
                                        Modus = <strong>72</strong>

                                        <strong>d. Range (Jangkauan)</strong>
                                        Range = Data Terbesar - Data Terkecil
                                        Range = 80 - 65 = <strong>15</strong>

                                        <strong>e. Standar Deviasi (Simpangan Baku Sampel)</strong>
                                        1. Hitung selisih kuadrat dari mean (72.5):
                                        (65-72.5)² = 56.25
                                        (68-72.5)² = 20.25
                                        ... dst sampai (80-72.5)²
                                        2. Jumlah Kuadrat (Sum of Squares) ≈ 205
                                        3. Varians (s²) = 205 / (12-1) = 18.636
                                        4. Standar Deviasi (s) = √18.636 ≈ <strong>4.32</strong>`
                                    },
                                    {
                                        id: "stda-essay-2",
                                        tipe: "essay",
                                        pertanyaan: `<strong>2. Visualisasi Data</strong><br>
                                        Data jumlah buku yang dipinjam:<br>
                                        <table class="soal-table">
                                            <tr><th>Kategori</th><th>Jumlah</th></tr>
                                            <tr><td>Fiksi</td><td>45</td></tr>
                                            <tr><td>Sains & Tek</td><td>30</td></tr>
                                            <tr><td>Sejarah</td><td>20</td></tr>
                                            <tr><td>Bahasa</td><td>25</td></tr>
                                            <tr><td>Bisnis & Eko</td><td>40</td></tr>
                                        </table>
                                        <strong>Pertanyaan:</strong><br>
                                        a. Hitung persentase untuk Diagram Lingkaran (Pie Chart)!<br>
                                        b. Kategori mana proporsi terkecil?<br>
                                        c. Termasuk visualisasi apa (univariat/bivariat)?`,
                                        pembahasan: `<strong>a. Perhitungan Persentase</strong>
                                        Total Data = 45 + 30 + 20 + 25 + 40 = <strong>160</strong>
                                        
                                        - Fiksi: (45/160) x 100% = <strong>28.125%</strong>
                                        - Sains & Tek: (30/160) x 100% = <strong>18.75%</strong>
                                        - Sejarah: (20/160) x 100% = <strong>12.5%</strong>
                                        - Bahasa: (25/160) x 100% = <strong>15.625%</strong>
                                        - Bisnis & Eko: (40/160) x 100% = <strong>25%</strong>

                                        <strong>b. Proporsi Terkecil</strong>
                                        Adalah kategori <strong>Sejarah</strong> (12.5% atau 20 buku).

                                        <strong>c. Jenis Visualisasi</strong>
                                        Ini termasuk analisis <strong>Univariat</strong>.
                                        Alasan: Kita hanya menganalisis satu variabel saja, yaitu "Jumlah Peminjaman" berdasarkan kategorinya, tanpa menghubungkannya dengan variabel lain (seperti jenis kelamin peminjam atau waktu peminjaman).`
                                    },
                                    {
                                        id: "stda-essay-3",
                                        tipe: "essay",
                                        pertanyaan: `<strong>3. Metode Deskriptif & Rumusan Masalah</strong><br>
                                        Kasus: Analisis data transaksi pelanggan e-commerce 2024.<br>
                                        
                                        <strong>Pertanyaan:</strong><br>
                                        a. Buat 1 rumusan masalah DESKRIPTIF yang sesuai!<br>
                                        b. Perbaiki rumusan berikut menjadi deskriptif: "Apakah ada pengaruh usia pelanggan terhadap total pembelian?"`,
                                        pembahasan: `<strong>a. Contoh Rumusan Masalah Deskriptif</strong>
                                        Rumusan deskriptif bertujuan "menggambarkan" bukan mencari "sebab-akibat".
                                        Contoh:
                                        - "Bagaimana profil demografi pelanggan yang melakukan transaksi tertinggi pada tahun 2024?"
                                        - "Produk kategori apa yang memiliki frekuensi penjualan tertinggi di setiap kuartal tahun 2024?"

                                        <strong>b. Perbaikan Rumusan Masalah</strong>
                                        Rumusan awal ("Apakah ada pengaruh...") adalah pertanyaan <em>Inferensial/Korelasional</em>.
                                        
                                        Perbaikan menjadi Deskriptif:
                                        - "Bagaimana sebaran/distribusi total pembelian pelanggan berdasarkan kelompok usia?"
                                        - "Berapa rata-rata total pembelian yang dilakukan oleh pelanggan pada tiap kelompok usia?"`
                                    },
                                    {
                                        id: "stda-essay-4",
                                        tipe: "essay",
                                        pertanyaan: `<strong>4. Decision Tree (Pohon Keputusan)</strong><br>
                                        Bank ingin memprediksi pembayaran kredit (Lancar/Macet).<br>
                                        <table class="soal-table">
                                            <tr><th>No</th><th>Penghasilan</th><th>Punya Rumah</th><th>Status Kredit</th></tr>
                                            <tr><td>1</td><td>Tinggi</td><td>Ya</td><td>Lancar</td></tr>
                                            <tr><td>2</td><td>Tinggi</td><td>Tidak</td><td>Lancar</td></tr>
                                            <tr><td>3</td><td>Rendah</td><td>Ya</td><td>Lancar</td></tr>
                                            <tr><td>4</td><td>Rendah</td><td>Tidak</td><td>Macet</td></tr>
                                            <tr><td>5</td><td>Sedang</td><td>Ya</td><td>Lancar</td></tr>
                                            <tr><td>6</td><td>Sedang</td><td>Tidak</td><td>Macet</td></tr>
                                            <tr><td>7</td><td>Tinggi</td><td>Ya</td><td>Lancar</td></tr>
                                            <tr><td>8</td><td>Rendah</td><td>Tidak</td><td>Macet</td></tr>
                                        </table>
                                        <strong>Pertanyaan:</strong><br>
                                        Tentukan Root Node terbaik dan prediksi status kredit untuk nasabah dengan: <strong>Penghasilan = Sedang, Punya Rumah = Ya</strong>.`,
                                        pembahasan: `<strong>Analisis untuk Root Node:</strong>
                                        Lihat pola datanya:
                                        Total Data: 8 (5 Lancar, 3 Macet).

                                        <strong>Cek Atribut "Punya Rumah":</strong>
                                        - Jika Punya Rumah = <strong>YA</strong> (Data no 1, 3, 5, 7): Status Kreditnya SEMUA <strong>Lancar</strong>. (Murni/Pure).
                                        - Jika Punya Rumah = <strong>TIDAK</strong> (Data no 2, 4, 6, 8): 
                                           - No 2 (Tinggi) -> Lancar
                                           - No 4, 6, 8 -> Macet
                                        
                                        Karena atribut "Punya Rumah = Ya" langsung menghasilkan klasifikasi murni (pasti Lancar), maka <strong>Punya Rumah</strong> adalah kandidat Root Node terbaik dibandingkan Penghasilan.

                                        <strong>Prediksi Kasus:</strong>
                                        Data: Penghasilan = Sedang, Punya Rumah = Ya.
                                        
                                        Berdasarkan pola di atas:
                                        Siapapun yang <strong>Punya Rumah = Ya</strong>, status kreditnya adalah <strong>Lancar</strong>.
                                        
                                        <strong>Jawaban: Lancar</strong>`
                                    }
                                ]
                            }
                        }
                    }
                ]);

                // --- STATE SESSION & HISTORY ---
                const userHistory = ref([]);
                const currentSessionMap = ref({});

                // --- NAVIGATION METHODS ---
                const selectMatkul = (mk) => {
                    selectedMatkul.value = mk;
                    step.value = 2;
                };
                const selectModul = (modulName) => {
                    selectedModulName.value = modulName;
                    step.value = 3;
                };
                const selectTes = (tesName) => {
                    selectedTesName.value = tesName;
                    const key = getTesSessionKey();
                    if(!currentSessionMap.value[key]) {
                        currentSessionMap.value[key] = Date.now();
                    }
                    step.value = 4;
                    window.scrollTo(0,0);
                    showEssay.value = {}; // Reset essay toggles
                };
                const goBack = () => {
                    if(step.value > 1) step.value--;
                };
                const goHome = () => {
                    step.value = 1;
                    selectedMatkul.value = null;
                };

                const toggleEssayAnswer = (id) => {
                    showEssay.value[id] = !showEssay.value[id];
                };

                // --- LOGIC HELPERS ---
                const getTesList = computed(() => {
                    if (!selectedMatkul.value || !selectedModulName.value) return {};
                    return selectedMatkul.value.modul[selectedModulName.value];
                });

                const currentSoalList = computed(() => {
                    if (step.value !== 4) return [];
                    return getTesList.value[selectedTesName.value];
                });

                const getTesSessionKey = () => {
                    return `${selectedMatkul.value.kode}-${selectedModulName.value}-${selectedTesName.value}`;
                };

                const getCurrentTesSessionID = () => {
                    const key = getTesSessionKey();
                    return currentSessionMap.value[key] || 0;
                };

                // --- ANSWER LOGIC (PG ONLY) ---
                const submitAnswer = (soal, selectedKey) => {
                    if (soal.tipe === 'essay') return; // Essay tidak ada auto-check

                    const isCorrect = selectedKey === soal.kunci;
                    const record = {
                        soalId: soal.id,
                        selected: selectedKey,
                        isCorrect: isCorrect,
                        timestamp: new Date().toISOString(),
                        tesSessionId: getCurrentTesSessionID(),
                        matkul: selectedMatkul.value.kode,
                        modul: selectedModulName.value,
                        tes: selectedTesName.value
                    };
                    userHistory.value.unshift(record);
                    saveHistory();
                };

                const resetCurrentTes = () => {
                    if(confirm("Yakin ingin mereset sesi ini?")) {
                        const key = getTesSessionKey();
                        currentSessionMap.value[key] = Date.now();
                        showEssay.value = {};
                        saveHistory();
                    }
                };

                const isAnsweredInCurrentSession = (soalId) => {
                    const currentID = getCurrentTesSessionID();
                    return userHistory.value.some(h => h.soalId === soalId && h.tesSessionId === currentID);
                };

                const getLastAnswer = (soalId) => {
                    const currentID = getCurrentTesSessionID();
                    return userHistory.value.find(h => h.soalId === soalId && h.tesSessionId === currentID);
                };

                const hasHistory = (matkul, modul, tes) => {
                     return userHistory.value.some(h => h.matkul === matkul && h.modul === modul && h.tes === tes);
                };

                // --- STYLING HELPERS ---
                const getOptionClass = (soal, key) => {
                    const answer = getLastAnswer(soal.id);
                    if (!answer) return 'border-slate-200 hover:bg-slate-50 hover:border-indigo-300';
                    if (answer.selected === key) {
                        return answer.isCorrect 
                            ? 'bg-green-100 border-green-500 ring-1 ring-green-500' 
                            : 'bg-red-100 border-red-500 ring-1 ring-red-500';
                    }
                    return 'opacity-50 border-slate-100 cursor-not-allowed';
                };

                const getOptionBulletClass = (soal, key) => {
                     const answer = getLastAnswer(soal.id);
                     if (!answer) return 'border-slate-300 text-slate-400 group-hover:border-indigo-400 group-hover:text-indigo-400';
                     if (answer.selected === key) {
                        return answer.isCorrect ? 'border-green-600 text-green-700 bg-white' : 'border-red-600 text-red-700 bg-white';
                     }
                     return 'border-slate-200 text-slate-300';
                };

                // --- STORAGE ---
                const saveHistory = () => {
                    localStorage.setItem('ut_latihan_history', JSON.stringify(userHistory.value));
                    localStorage.setItem('ut_latihan_sessions', JSON.stringify(currentSessionMap.value));
                };

                const loadHistory = () => {
                    const h = localStorage.getItem('ut_latihan_history');
                    const s = localStorage.getItem('ut_latihan_sessions');
                    if (h) userHistory.value = JSON.parse(h);
                    if (s) currentSessionMap.value = JSON.parse(s);
                };

                onMounted(() => {
                    loadHistory();
                });

                return {
                    step, matakuliahList, selectedMatkul, selectedModulName, selectedTesName,
                    getTesList, currentSoalList, selectMatkul, selectModul, selectTes,
                    goBack, goHome, submitAnswer, isAnsweredInCurrentSession, getLastAnswer,
                    getOptionClass, getOptionBulletClass, resetCurrentTes, hasHistory,
                    toggleEssayAnswer, showEssay
                };
            }
        }).mount('#app');
    </script>
</body>
</html>
